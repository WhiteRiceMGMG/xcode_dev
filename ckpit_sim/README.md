#I/F一覧(初期案)

公開I/F名
SWIFT-C間の公開和名　　　　　　　　　 機能ラベル   モジュール
---
アクセル開度(%)                      | pwrtrn     | 
ブレーキ開度(%)                      | pwrtrn     |
クラッチ開度(%)                      | pwrtrn     |
ギアシフト情報(1-5,R,N)              | pwrtrn     |
回転数(rpm)                          | pwrtrn     |
スピード(km/h)                       | pwrtrn     |
エンストフラグ(ビットフラグ)         | prtct      |
IG-ON許可フラグ(ビットフラグ)        | perm       |
ギアシフト許可フラグ(ビットフラグ)   | perm       |
オーバレブ状態フラグ(ビットフラグ)   | prtct      |
半クラ焼きつきフラグ(ビットフラグ)   | prtct      |
ブレーキ焼きつきフラグ(ビットフラグ) | prtct      |
IG-ON状態フラグ                      | perm       |

モジュール名と機能
【アクセル補正】acelcrt
  入力されたアクセル開度(%)を補正して公開する．

【ブレーキ補正】brakcrt
  入力されたブレーキ開度(%)を補正して公開する．

【クラッチ補正】clthcrt
  入力されたクラッチ開度(%)を補正して公開する．

【ギアシフト情報補正】gearcrt
  入力されたギアシフトを演算用定数に変換して公開する．

【有効トルク演算】trqcal
  補正済みのアクセル補正値を用いて有効トルクを算出して公開する。
  
【有効抵抗演算】drgcal
  空気抵抗や転がり抵抗などの抵抗を算出して公開する。
  算出値は加速度算出等で使用する。
  
【速度・加速度演算】 velaclcal 
  加速度と速度を算出して公開する。
  
 【エンスト判定】


#ざっくり仕様
##全体の流れ
IG-ONしたらアクセル，ブレーキ，クラッチ開度を0%に．シフトはNにセット．
同時にIG-ON状態フラグを除く全ての状態を初期状態に戻す．
アクセル開度を取得し，シフト情報とクラッチ開度とブレーキ開度でスピードと回転数を算出．

[詳細]
アクセル→回転数を操作？ ←違うような．．．！！エンジントルク導入！！
アクセルはスピードと回転数に直結するわけでなく，エンジントルクに直接結びついている（？）
アクセル開度を５０％にすれば，単純モデルでエンジントルクはMAXトルクx50%になる．
ギアはトルク増幅装置だと捉えて，[1,2,3,4,5] = [3.5, 2.1, 1.7, 1.4, 1.1]くらいの定数
で，次にざっくり空気抵抗と転がり抵抗を軽くかけて，加速度はトルク x ギア x (speed x speed x 定数)
加速度を求めたらここから積分して速度を求める．算出した速度を回転数と結びつける？？

[数値モデル]
トルク = MAXトルク x スロットル開度 
有効トルク = トルク x クラッチ結合率
加速度 = ( 有効トルク x ギア比 ) - 抵抗 - ブレーキ
  抵抗 = speed x speed x 定数
速度(次)   =  速度(前) + 加速度 x 刻み幅単位 (確かLAMMPS(仮)で -x/2, +x/2を組み込んだ気が...?)
回転数 = 速度 x ギア比 x 定数

engineTorque = throttle × MAXTORQUE
driveTorque = clutch × engineTorque × gearRatio
brakeForce = brake × MAX-BRAKE-FORCE
airDrag = speed x speed × Cdrag
accel = (driveTorque - brakeForce - airDrag) / mass
speed += accel × dt


結論：シミュレータ演算専用のモジュール作っとく




#コンポーネント(モジュール)ざっくり版
##Powertrain
駆動関係の演算

##Protection
保護ロジック

##Permission
動作許可ロジック

##Bridge
Cロジック提供ロジック




#MarkDownざっくり版
# 大見出し
## 中見出し
### 小見出し

## 箇条書き
- スロットル値
- ブレーキ値
- クラッチ値

**太文字**

## コードを書くとき
`g_sliderValue`
<pre> ```c double g_sliderValue; ``` </pre>
